CREATE VIEW contableconceptos_contable AS
    ((((SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'D' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_unidadadmin, sno_salida, sno_concepto, spg_cuentas, scg_cuentas, spg_ep1 WHERE ((((((((((((((((((((((((((((((sno_salida.tipsal = 'A'::bpchar) OR (sno_salida.tipsal = 'V1'::bpchar)) OR (sno_salida.tipsal = 'W1'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((sno_concepto.intprocon)::text = '1'::text)) AND ((spg_cuentas.status)::text = 'C'::text)) AND (spg_ep1.estint = 0)) AND (substr((sno_concepto.codpro)::text, 1, 25) = (spg_ep1.codestpro1)::text)) AND ((spg_ep1.estcla)::text = (sno_concepto.estcla)::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (sno_personalnomina.codemp = sno_unidadadmin.codemp)) AND (sno_personalnomina.minorguniadm = sno_unidadadmin.minorguniadm)) AND (sno_personalnomina.ofiuniadm = sno_unidadadmin.ofiuniadm)) AND (sno_personalnomina.uniuniadm = sno_unidadadmin.uniuniadm)) AND (sno_personalnomina.depuniadm = sno_unidadadmin.depuniadm)) AND (sno_personalnomina.prouniadm = sno_unidadadmin.prouniadm)) AND (spg_cuentas.codemp = sno_concepto.codemp)) AND ((spg_cuentas.spg_cuenta)::bpchar = (sno_concepto.cueprecon)::bpchar)) AND ((spg_cuentas.sc_cuenta)::bpchar = (scg_cuentas.sc_cuenta)::bpchar)) AND (substr((sno_concepto.codpro)::text, 1, 25) = (spg_cuentas.codestpro1)::text)) AND (substr((sno_concepto.codpro)::text, 26, 25) = (spg_cuentas.codestpro2)::text)) AND (substr((sno_concepto.codpro)::text, 51, 25) = (spg_cuentas.codestpro3)::text)) AND (substr((sno_concepto.codpro)::text, 76, 25) = (spg_cuentas.codestpro4)::text)) AND (substr((sno_concepto.codpro)::text, 101, 25) = (spg_cuentas.codestpro5)::text)) AND ((sno_concepto.estcla)::text = (spg_cuentas.estcla)::text)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi UNION SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'D' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_unidadadmin, sno_salida, sno_concepto, spg_cuentas, scg_cuentas, spg_ep1 WHERE ((((((((((((((((((((((((((((((sno_salida.tipsal = 'A'::bpchar) OR (sno_salida.tipsal = 'V1'::bpchar)) OR (sno_salida.tipsal = 'W1'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((sno_concepto.intprocon)::text = '0'::text)) AND ((spg_cuentas.status)::text = 'C'::text)) AND (spg_ep1.estint = 0)) AND (substr((sno_unidadadmin.codprouniadm)::text, 1, 25) = (spg_ep1.codestpro1)::text)) AND ((spg_ep1.estcla)::text = (sno_unidadadmin.estcla)::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (sno_personalnomina.codemp = sno_unidadadmin.codemp)) AND (sno_personalnomina.minorguniadm = sno_unidadadmin.minorguniadm)) AND (sno_personalnomina.ofiuniadm = sno_unidadadmin.ofiuniadm)) AND (sno_personalnomina.uniuniadm = sno_unidadadmin.uniuniadm)) AND (sno_personalnomina.depuniadm = sno_unidadadmin.depuniadm)) AND (sno_personalnomina.prouniadm = sno_unidadadmin.prouniadm)) AND (spg_cuentas.codemp = sno_concepto.codemp)) AND ((spg_cuentas.spg_cuenta)::bpchar = (sno_concepto.cueprecon)::bpchar)) AND ((spg_cuentas.sc_cuenta)::bpchar = (scg_cuentas.sc_cuenta)::bpchar)) AND (substr((sno_unidadadmin.codprouniadm)::text, 1, 25) = (spg_cuentas.codestpro1)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 26, 25) = (spg_cuentas.codestpro2)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 51, 25) = (spg_cuentas.codestpro3)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 76, 25) = (spg_cuentas.codestpro4)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 101, 25) = (spg_cuentas.codestpro5)::text)) AND ((sno_unidadadmin.estcla)::text = (spg_cuentas.estcla)::text)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi) UNION SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'D' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_salida, sno_concepto, scg_cuentas WHERE (((((((((((((((sno_salida.tipsal = 'A'::bpchar) OR (sno_salida.tipsal = 'V1'::bpchar)) OR (sno_salida.tipsal = 'W1'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((sno_concepto.intprocon)::text = '0'::text)) AND ((scg_cuentas.status)::text = 'C'::text)) AND ((sno_concepto.sigcon)::text = 'B'::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (scg_cuentas.codemp = sno_concepto.codemp)) AND ((scg_cuentas.sc_cuenta)::bpchar = (sno_concepto.cueconcon)::bpchar)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi) UNION SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'H' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_salida, sno_concepto, scg_cuentas WHERE ((((((((((((((((sno_salida.tipsal = 'D'::bpchar) OR (sno_salida.tipsal = 'V2'::bpchar)) OR (sno_salida.tipsal = 'W2'::bpchar)) OR (sno_salida.tipsal = 'P1'::bpchar)) OR (sno_salida.tipsal = 'V3'::bpchar)) OR (sno_salida.tipsal = 'W3'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((scg_cuentas.status)::text = 'C'::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (scg_cuentas.codemp = sno_concepto.codemp)) AND ((scg_cuentas.sc_cuenta)::bpchar = (sno_concepto.cueconcon)::bpchar)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi) UNION SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'H' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_unidadadmin, sno_salida, sno_concepto, spg_cuentas, scg_cuentas, spg_ep1 WHERE ((((((((((((((((((((((((((((((((((sno_salida.tipsal = 'D'::bpchar) OR (sno_salida.tipsal = 'V2'::bpchar)) OR (sno_salida.tipsal = 'W2'::bpchar)) OR (sno_salida.tipsal = 'P1'::bpchar)) OR (sno_salida.tipsal = 'V3'::bpchar)) OR (sno_salida.tipsal = 'W3'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((sno_concepto.intprocon)::text = '1'::text)) AND ((sno_concepto.sigcon)::text = 'E'::text)) AND ((spg_cuentas.status)::text = 'C'::text)) AND (spg_ep1.estint = 0)) AND (substr((sno_concepto.codpro)::text, 1, 25) = (spg_ep1.codestpro1)::text)) AND ((spg_ep1.estcla)::text = (sno_concepto.estcla)::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (sno_personalnomina.codemp = sno_unidadadmin.codemp)) AND (sno_personalnomina.minorguniadm = sno_unidadadmin.minorguniadm)) AND (sno_personalnomina.ofiuniadm = sno_unidadadmin.ofiuniadm)) AND (sno_personalnomina.uniuniadm = sno_unidadadmin.uniuniadm)) AND (sno_personalnomina.depuniadm = sno_unidadadmin.depuniadm)) AND (sno_personalnomina.prouniadm = sno_unidadadmin.prouniadm)) AND (spg_cuentas.codemp = sno_concepto.codemp)) AND ((spg_cuentas.spg_cuenta)::bpchar = (sno_concepto.cueprecon)::bpchar)) AND ((spg_cuentas.sc_cuenta)::bpchar = (scg_cuentas.sc_cuenta)::bpchar)) AND (substr((sno_concepto.codpro)::text, 1, 25) = (spg_cuentas.codestpro1)::text)) AND (substr((sno_concepto.codpro)::text, 26, 25) = (spg_cuentas.codestpro2)::text)) AND (substr((sno_concepto.codpro)::text, 51, 25) = (spg_cuentas.codestpro3)::text)) AND (substr((sno_concepto.codpro)::text, 76, 25) = (spg_cuentas.codestpro4)::text)) AND (substr((sno_concepto.codpro)::text, 101, 25) = (spg_cuentas.codestpro5)::text)) AND ((sno_concepto.estcla)::text = (spg_cuentas.estcla)::text)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi) UNION SELECT scg_cuentas.sc_cuenta AS cuenta, max((scg_cuentas.denominacion)::text) AS denominacion, 'H' AS operacion, sum(sno_salida.valsal) AS total, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi FROM sno_personalnomina, sno_unidadadmin, sno_salida, sno_concepto, spg_cuentas, scg_cuentas, spg_ep1 WHERE ((((((((((((((((((((((((((((((((((sno_salida.tipsal = 'D'::bpchar) OR (sno_salida.tipsal = 'V2'::bpchar)) OR (sno_salida.tipsal = 'W2'::bpchar)) OR (sno_salida.tipsal = 'P1'::bpchar)) OR (sno_salida.tipsal = 'V3'::bpchar)) OR (sno_salida.tipsal = 'W3'::bpchar)) AND (sno_salida.valsal <> (0)::double precision)) AND ((sno_concepto.intprocon)::text = '0'::text)) AND ((sno_concepto.sigcon)::text = 'E'::text)) AND ((spg_cuentas.status)::text = 'C'::text)) AND (spg_ep1.estint = 0)) AND (substr((sno_unidadadmin.codprouniadm)::text, 1, 25) = (spg_ep1.codestpro1)::text)) AND ((spg_ep1.estcla)::text = (sno_unidadadmin.estcla)::text)) AND (sno_personalnomina.codemp = sno_salida.codemp)) AND (sno_personalnomina.codnom = sno_salida.codnom)) AND (sno_personalnomina.codper = sno_salida.codper)) AND (sno_salida.codemp = sno_concepto.codemp)) AND (sno_salida.codnom = sno_concepto.codnom)) AND (sno_salida.codconc = sno_concepto.codconc)) AND (sno_personalnomina.codemp = sno_unidadadmin.codemp)) AND (sno_personalnomina.minorguniadm = sno_unidadadmin.minorguniadm)) AND (sno_personalnomina.ofiuniadm = sno_unidadadmin.ofiuniadm)) AND (sno_personalnomina.uniuniadm = sno_unidadadmin.uniuniadm)) AND (sno_personalnomina.depuniadm = sno_unidadadmin.depuniadm)) AND (sno_personalnomina.prouniadm = sno_unidadadmin.prouniadm)) AND (spg_cuentas.codemp = sno_concepto.codemp)) AND ((spg_cuentas.spg_cuenta)::bpchar = (sno_concepto.cueprecon)::bpchar)) AND ((spg_cuentas.sc_cuenta)::bpchar = (scg_cuentas.sc_cuenta)::bpchar)) AND (substr((sno_unidadadmin.codprouniadm)::text, 1, 25) = (spg_cuentas.codestpro1)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 26, 25) = (spg_cuentas.codestpro2)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 51, 25) = (spg_cuentas.codestpro3)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 76, 25) = (spg_cuentas.codestpro4)::text)) AND (substr((sno_unidadadmin.codprouniadm)::text, 101, 25) = (spg_cuentas.codestpro5)::text)) AND ((sno_unidadadmin.estcla)::text = (spg_cuentas.estcla)::text)) GROUP BY scg_cuentas.sc_cuenta, sno_salida.codemp, sno_salida.codnom, sno_salida.codperi;


ALTER TABLE public.contableconceptos_contable OWNER TO postgres;

